# 工作流规则 (Workflow Rules)

> 确保每个阶段按照正确的顺序执行，不跳步，不遗漏。

## 完整工作流程图

```
用户需求
    ↓
Phase 1: 需求理解与选题策划
    ├─ 1.1 理解需求
    ├─ 1.2 深度调研
    └─ 1.3 选题生成 → 等待用户确认 ✋
         ↓
Phase 2: 初稿创作
    ├─ 2.1 加载 Vibe 风格
    ├─ 2.2 撰写初稿 v1
    └─ 2.3 输出初稿
         ↓
Phase 3: 三遍审校
    ├─ 3.1 第一遍：内容审校
    ├─ 3.2 第二遍：风格审校
    └─ 3.3 第三遍：细节打磨
         ↓
Phase 4: 视觉设计
    ├─ 4.1 分析配图需求
    ├─ 4.2 生成配图提示词
    └─ 4.3 调用 image-generator
         ↓
Phase 5: 多平台分发
    ├─ 5.1 询问分发需求
    └─ 5.2 调用 content-converter
         ↓
Phase 6: 最终交付
    └─ 6.1 交付清单
```

## 必须遵守的规则

### Rule 1: 选题必须等待用户确认

**❌ 错误做法**:
```
[生成 3 个选题]

我选择了选题 1，现在开始写作...  ← 错误！
```

**✅ 正确做法**:
```
[生成 3 个选题]

请选择你感兴趣的选题编号（1/2/3），或告诉我需要调整的方向。

[等待用户回复]
```

### Rule 2: 不跳过调研阶段

**必须完成的调研内容**:
- [ ] 搜索最新信息（过去 6 个月内）
- [ ] 找到至少 2 个真实案例
- [ ] 收集至少 1 个数据支撑
- [ ] 调用 `personal-knowledge-search` 查找个人素材库
- [ ] 了解竞品内容的角度

**❌ 不能**:
- 直接开始写作，没有调研
- 编造案例和数据
- 使用过时信息（超过 1 年）

### Rule 3: 三遍审校不能合并

**必须分别完成**:
1. **第一遍**：内容审校（事实、逻辑、原创性）
2. **第二遍**：风格审校（6 大类 AI 腔）
3. **第三遍**：细节打磨（句子、段落、标点、加粗）

**❌ 不能**:
- 一遍审校就完成所有检查
- 跳过某一遍审校
- 只做风格审校，不做内容审校

### Rule 4: 初稿必须包含真实证据

**强制要求**:
- [ ] 至少 2 个**真实案例**（具体到时间、人物、场景）
- [ ] 至少 1 个**数据支撑**（统计数据、对比数据）
- [ ] 如果是技术文章，至少 1 个**代码片段**

**❌ 不能**:
- 只有观点陈述，没有证据
- 使用模糊的"最近"、"很多人"
- 编造案例和数据

### Rule 5: 配图必须混合策略

**配图组合**:
1. **封面图**（必须）：AI 生成的概念图
2. **章节配图**（可选）：AI 生成的概念图
3. **真实截图**（必须）：产品界面/代码/数据图表

**❌ 不能**:
- 只用 AI 生成的图
- 只用真实截图
- 没有封面图

### Rule 6: 多平台分发必须询问

**❌ 错误做法**:
```
文章完成！我已经为你生成了 X、微博、小红书的内容...  ← 没有询问用户
```

**✅ 正确做法**:
```
文章已完成！是否需要为其他平台生成内容？

支持平台：
1. X / Twitter
2. 微博
3. 小红书
...

[等待用户回复]
```

## 各阶段输出格式规范

### Phase 1.1 - 需求理解输出

```
【需求理解】

目标读者：[读者画像]
文章类型：[类型]
核心目标：[要解决什么问题/传递什么价值]
预估长度：[字数]
发布平台：[平台]
特殊要求：[如果有]
```

### Phase 1.2 - 调研输出

```
【调研完成】

找到相关资料：X 篇
真实案例：X 个
数据支撑：X 条
个人素材：X 条

核心发现：
1. [发现 1]
2. [发现 2]
3. [发现 3]

参考资料：
- [资料 1 标题 + 链接]
- [资料 2 标题 + 链接]
```

### Phase 1.3 - 选题生成输出

```
【选题提案】

根据调研，我为你准备了 3 个选题方向：

---

### 选题 1：[标题]

**核心角度**：[一句话说明独特视角]

**为什么值得写**：
- [理由 1]
- [理由 2]

**预估工作量**：[短/中/长]

**文章大纲**：
1. [章节 1]
2. [章节 2]
3. [章节 3]

---

[选题 2、选题 3 同样格式]

---

请选择你感兴趣的选题编号（1/2/3），或告诉我需要调整的方向。
```

### Phase 2.3 - 初稿输出

```
【初稿 v1 完成】

全文字数：XXX 字
真实案例：X 个
数据支撑：X 条
代码片段：X 个（如果是技术文章）

---

[完整初稿内容 - Markdown 格式]

---

接下来进入三遍审校流程。
```

### Phase 3.1 - 第一遍审校输出

```
【第一遍审校完成 - 内容审校】

检查项：
- ✅ 事实准确性：已核实所有数据和人名
- ✅ 逻辑清晰性：论证链条完整
- ✅ 无编造信息：所有案例均真实
- ✅ 原创性：非网络复制内容

修正问题：
- [问题 1 及修正方案]
- [问题 2 及修正方案]

状态：✅ 通过 / ⚠️ 需要补充素材
```

### Phase 3.2 - 第二遍审校输出

```
【第二遍审校完成 - 风格审校】

修改统计：
- 删除套话：X 处
- 拆分长句：X 处
- 口语化改写：X 处
- 添加真实细节：X 处

主要修改示例：
1. ❌ [修改前]
   ✅ [修改后]
2. ❌ [修改前]
   ✅ [修改后]
3. ❌ [修改前]
   ✅ [修改后]

AI 腔类型分布：
- 套话连篇：X 处
- 机械句式：X 处
- 书面词汇：X 处
- 结构机械：X 处
- 态度中立：X 处
- 细节缺失：X 处
```

### Phase 3.3 - 第三遍审校输出

```
【第三遍审校完成 - 细节打磨】

最终字数：XXX 字
段落数：X 个
平均句长：X 字
加粗关键词：X 处

调整内容：
- 句子长度：拆分了 X 个长句
- 段落长度：调整了 X 个超过 8 行的段落
- 标点节奏：优化了 X 处标点使用
- 加粗控制：确保每 200-300 字 1-2 处加粗

---

【审校后完整文章】

[输出审校后的完整 Markdown 文章]

---

状态：✅ 审校完成，准备配图
```

### Phase 4.2 - 配图方案输出

```
【配图方案】

需要生成：X 张图片

---

### 图 1：封面图

**用途**：文章封面
**风格**：现代简约，科技感
**提示词**：
"[完整的 AI 图片生成提示词]"

---

### 图 2：章节配图 - [章节名称]

**用途**：[章节] 配图
**风格**：[风格描述]
**提示词**：
"[完整的 AI 图片生成提示词]"

---

[继续列出所有配图]

---

需要真实截图：
- [截图 1 描述]
- [截图 2 描述]

正在调用 image-generator 生成图片...
```

### Phase 4.3 - 配图完成输出

```
【配图完成】

生成图片：X 张
图床上传：X 张
Markdown 链接已生成

---

### 配图列表

| 位置 | 描述 | 链接 |
|-----|------|------|
| 封面 | [标题] | ![cover](URL) |
| 章节 1 | [小标题] | ![](URL) |
| 章节 2 | [小标题] | ![](URL) |

---

【完整文章（含配图）】

[输出包含配图的完整 Markdown 文章]
```

### Phase 5.2 - 多平台分发输出

```
【多平台内容生成完成】

已生成：
- ✅ X Thread（X 条）
- ✅ 微博文案（1 条）
- ✅ 小红书笔记（1 篇）

---

## X / Twitter Thread

🧵 1/[总数]
[第 1 条内容]

---

🧵 2/[总数]
[第 2 条内容]

---

[继续...]

---

## 微博文案

[微博文案内容]

话题标签：#标签1 #标签2

---

## 小红书笔记

[小红书笔记内容]
```

### Phase 6.1 - 最终交付输出

```
【创作完成 🎉】

交付内容：
1. ✅ 完整文章（Markdown 格式，含配图）
2. ✅ 封面图 + 章节配图（已上传图床）
3. ✅ 多平台分发内容（X/微博/小红书等）

---

文章统计：
- 最终字数：XXX 字
- 段落数：X 个
- 真实案例：X 个
- 数据支撑：X 条
- 配图数量：X 张
- AI 味评分：⭐⭐⭐⭐⭐（极低）

---

创作时间线：
- 需求理解：✅
- 选题策划：✅
- 深度调研：✅
- 初稿创作：✅
- 三遍审校：✅
- 视觉设计：✅
- 多平台分发：✅

---

【完整文章】

[输出最终完整 Markdown 文章]

---

祝发布顺利！🚀
```

## 质量检查清单

### 初稿质量检查

- [ ] 开场没有套话，直接切入
- [ ] 至少 2 个真实案例（具体时间、人物、场景）
- [ ] 至少 1 个数据支撑（具体数字）
- [ ] 技术文章包含至少 1 个代码片段
- [ ] 没有编造的信息
- [ ] 逻辑链条完整

### 审校质量检查

- [ ] 第一遍：事实准确性已核实
- [ ] 第一遍：逻辑清晰性已确认
- [ ] 第二遍：6 大类 AI 腔已识别并改写
- [ ] 第二遍：书面词汇已口语化
- [ ] 第三遍：句子长度适中（15-25 字）
- [ ] 第三遍：段落长度适中（3-5 行）
- [ ] 第三遍：加粗不超过 2 处/200 字

### 配图质量检查

- [ ] 封面图已生成
- [ ] 章节配图已配齐（如需要）
- [ ] 真实截图已准备（如需要）
- [ ] 所有图片已上传图床
- [ ] Markdown 链接已嵌入文章

### 分发质量检查

- [ ] 已询问用户分发需求
- [ ] 各平台内容已生成
- [ ] 风格适配平台特点
- [ ] 核心观点保留完整

## 异常处理

### 情况 1: 用户对选题不满意

**处理流程**:
1. 询问具体的不满意之处
2. 根据反馈调整选题角度
3. 重新生成 3 个选题
4. 等待用户确认

### 情况 2: 找不到足够的真实案例

**处理流程**:
1. 调用 `personal-knowledge-search` 搜索个人素材库
2. 询问用户是否有相关经历
3. 如果仍然不足，建议调整选题角度
4. 不编造案例

### 情况 3: 用户对初稿不满意

**处理流程**:
1. 询问具体的不满意之处
2. 理解用户反馈
3. 根据反馈调整写作角度或风格
4. 生成 v2 版本
5. 重新进入审校流程

### 情况 4: 配图生成失败

**处理流程**:
1. 检查提示词是否合理
2. 调整提示词重新生成
3. 如果仍然失败，建议使用其他图片来源
4. 询问用户是否有替代图片

## 时间管理建议

### 各阶段预估时长

| 阶段 | 预估时长 | 可压缩 |
|-----|---------|--------|
| Phase 1.1 需求理解 | 2-3 分钟 | ❌ |
| Phase 1.2 深度调研 | 5-10 分钟 | ⚠️ |
| Phase 1.3 选题生成 | 3-5 分钟 | ❌ |
| Phase 2 初稿创作 | 10-20 分钟 | ⚠️ |
| Phase 3 三遍审校 | 8-15 分钟 | ❌ |
| Phase 4 视觉设计 | 5-10 分钟 | ✅ |
| Phase 5 多平台分发 | 3-5 分钟 | ✅ |

**注意**:
- ❌ = 不可压缩，必须完成
- ⚠️ = 可适度压缩，但会影响质量
- ✅ = 可选项，可根据需求跳过

---

*严格遵守工作流规则，确保输出质量。* ✅
